<Window x:Class="Kaenx.Creator.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Kaenx.Creator"
        xmlns:models="clr-namespace:Kaenx.Creator.Models"
        xmlns:conv="clr-namespace:Kaenx.Creator.Converter"
        xmlns:dyn="clr-namespace:Kaenx.Creator.Models.Dynamic"
        xmlns:System="clr-namespace:System;assembly=mscorlib"
        xmlns:select="clr-namespace:Kaenx.Creator.Selectors"
        xmlns:p="clr-namespace:Kaenx.Creator.Properties"
        xmlns:avalonedit="http://icsharpcode.net/sharpdevelop/avalonedit"
        mc:Ignorable="d"
        Icon="FileLogo.ico"
        Title="Kaenx Creator" Height="700" Width="1000">
    <Window.Resources>
        <conv:BoolNegation x:Key="BoolNegate" />
        <conv:EmptyOListToBool x:Key="EmptyListToBool" />
        <conv:EmptyToBool x:Key="EmptyToBool" />
        <conv:EnumToVisibility x:Key="EnumToVis" />
        <conv:EnumToVisibility x:Key="EnumToVisNeg" Negate="True" />
        <conv:BoolToVisibility x:Key="BoolToVis" />
        <conv:TypeToBool x:Key="TypeToBool" />
        <conv:StateToBrush x:Key="StateToBrush" />

        <Style x:Key="TopTabControl" TargetType="TabControl">
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabControl">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <Border BorderThickness="0 4 0 0" BorderBrush="#D0CEBF" Grid.Row="1">
                                <Border BorderThickness="{TemplateBinding BorderThickness}" BorderBrush="{TemplateBinding BorderBrush}">
                                    <Border Background="{TemplateBinding Background}">
                                        <ContentPresenter ContentSource="SelectedContent"/>
                                    </Border>
                                </Border>
                            </Border>
                            <TabPanel Grid.Row="0" IsItemsHost="true" Margin="10 0" />
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="LeftTabControl" TargetType="TabControl">
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabControl">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="auto" />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <Border BorderThickness="4 0 0 0" BorderBrush="#D0CEBF" Grid.Column="1">
                                <Border BorderThickness="{TemplateBinding BorderThickness}" BorderBrush="{TemplateBinding BorderBrush}">
                                    <Border Background="{TemplateBinding Background}">
                                        <ContentPresenter ContentSource="SelectedContent"/>
                                    </Border>
                                </Border>
                            </Border>
                            <TabPanel IsItemsHost="true"/>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="TopTabItem" TargetType="TabItem">
            <Setter Property="BorderThickness" Value="0 0 0 4" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type TabItem}">
                        <Border Padding="0 0 0 7" Background="Transparent">
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup x:Name="SelectionStates">
                                    <VisualState x:Name="Unselected">
                                        <Storyboard>
                                            <ColorAnimationUsingKeyFrames Duration="0:0:0.5" Storyboard.TargetName="Border" Storyboard.TargetProperty="BorderBrush.Color">
                                                <EasingColorKeyFrame KeyTime="0:0:0.5" Value="Transparent" />
                                            </ColorAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="Selected">
                                        <Storyboard>
                                            <ColorAnimationUsingKeyFrames Duration="0:0:0.5" Storyboard.TargetName="Border" Storyboard.TargetProperty="BorderBrush.Color">
                                                <EasingColorKeyFrame KeyTime="0:0:0.5" Value="Green" />
                                            </ColorAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                </VisualStateGroup>
                                <VisualStateGroup x:Name="CommonStates">
                                    <VisualState x:Name="Normal">
                                        <Storyboard>
                                            <DoubleAnimationUsingKeyFrames Duration="0:0:1" Storyboard.TargetName="Border" Storyboard.TargetProperty="Opacity">
                                                <LinearDoubleKeyFrame KeyTime="0:0:1" Value="1" />
                                            </DoubleAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="MouseOver" />
                                    <VisualState x:Name="Disabled">
                                        <Storyboard>
                                            <DoubleAnimationUsingKeyFrames Duration="0:0:1" Storyboard.TargetName="Border" Storyboard.TargetProperty="Opacity">
                                                <LinearDoubleKeyFrame KeyTime="0:0:1" Value="0.5" />
                                            </DoubleAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                            <Border.Resources>
                                <Style TargetType="TextBlock">
                                    <Setter Property="FontSize" Value="20" />
                                </Style>
                            </Border.Resources>
                            <Border Name="Border" BorderBrush="Transparent" BorderThickness="{TemplateBinding BorderThickness}" Padding="5 15 5 5" >
                                <ContentPresenter ContentSource="Header" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="5 0">
                                    <ContentPresenter.Resources>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="FontSize" Value="17" />
                                        </Style>
                                    </ContentPresenter.Resources>
                                </ContentPresenter>
                            </Border>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="LeftTabItem" TargetType="TabItem">
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type TabItem}">
                        <Border Padding="0 0 0 7" Background="Transparent">
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup x:Name="SelectionStates">
                                    <VisualState x:Name="Unselected">
                                        <Storyboard>
                                            <ColorAnimationUsingKeyFrames Duration="0:0:0.5" Storyboard.TargetName="Backx" Storyboard.TargetProperty="Color">
                                                <EasingColorKeyFrame KeyTime="0:0:0.5" Value="Transparent" />
                                            </ColorAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="Selected">
                                        <Storyboard>
                                            <ColorAnimationUsingKeyFrames Duration="0:0:0.5" Storyboard.TargetName="Backx" Storyboard.TargetProperty="Color">
                                                <EasingColorKeyFrame KeyTime="0:0:0.5" Value="Green" />
                                            </ColorAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                </VisualStateGroup>
                                <VisualStateGroup x:Name="CommonStates">
                                    <VisualState x:Name="Normal">
                                        <Storyboard>
                                            <DoubleAnimationUsingKeyFrames Duration="0:0:1" Storyboard.TargetName="Head" Storyboard.TargetProperty="Opacity">
                                                <LinearDoubleKeyFrame KeyTime="0:0:1" Value="1" />
                                            </DoubleAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="MouseOver" />
                                    <VisualState x:Name="Disabled">
                                        <Storyboard>
                                            <DoubleAnimationUsingKeyFrames Duration="0:0:1" Storyboard.TargetName="Head" Storyboard.TargetProperty="Opacity">
                                                <LinearDoubleKeyFrame KeyTime="0:0:1" Value="0.5" />
                                            </DoubleAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                            <Border.Resources>
                                <Style TargetType="TextBlock">
                                    <Setter Property="FontSize" Value="20" />
                                </Style>
                            </Border.Resources>

                            <Grid>
                                <Border Name="Border" BorderBrush="Transparent" BorderThickness="{TemplateBinding BorderThickness}" Padding="5" Opacity="0.5" >
                                    <Border.Background>
                                        <SolidColorBrush x:Name="Backx" Color="Transparent" />
                                    </Border.Background>
                                </Border>
                                <ContentPresenter Name="Head" ContentSource="Header" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="10" />
                            </Grid>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="LeftTabItem2" TargetType="TabItem">
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type TabItem}">
                        <Border Padding="0 0 0 7" Background="Transparent">
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup x:Name="SelectionStates">
                                    <VisualState x:Name="Unselected">
                                        <Storyboard>
                                            <ColorAnimationUsingKeyFrames Duration="0:0:0.5" Storyboard.TargetName="Backx" Storyboard.TargetProperty="Color">
                                                <EasingColorKeyFrame KeyTime="0:0:0.5" Value="Transparent" />
                                            </ColorAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="Selected">
                                        <Storyboard>
                                            <ColorAnimationUsingKeyFrames Duration="0:0:0.5" Storyboard.TargetName="Backx" Storyboard.TargetProperty="Color">
                                                <EasingColorKeyFrame KeyTime="0:0:0.5" Value="Red" />
                                            </ColorAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                </VisualStateGroup>
                                <VisualStateGroup x:Name="CommonStates">
                                    <VisualState x:Name="Normal">
                                        <Storyboard>
                                            <DoubleAnimationUsingKeyFrames Duration="0:0:1" Storyboard.TargetName="Head" Storyboard.TargetProperty="Opacity">
                                                <LinearDoubleKeyFrame KeyTime="0:0:1" Value="1" />
                                            </DoubleAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="MouseOver" />
                                    <VisualState x:Name="Disabled">
                                        <Storyboard>
                                            <DoubleAnimationUsingKeyFrames Duration="0:0:1" Storyboard.TargetName="Head" Storyboard.TargetProperty="Opacity">
                                                <LinearDoubleKeyFrame KeyTime="0:0:1" Value="0.5" />
                                            </DoubleAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                            <Border.Resources>
                                <Style TargetType="TextBlock">
                                    <Setter Property="FontSize" Value="20" />
                                </Style>
                            </Border.Resources>

                            <Grid>
                                <Border Name="Border" BorderBrush="Transparent" BorderThickness="{TemplateBinding BorderThickness}" Padding="5" Opacity="0.5" >
                                    <Border.Background>
                                        <SolidColorBrush x:Name="Backx" Color="Transparent" />
                                    </Border.Background>
                                </Border>
                                <ContentPresenter Name="Head" ContentSource="Header" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="10" />
                            </Grid>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <DataTemplate x:Key="TempDynMain">
            <TextBlock Margin="5" Text="Dieser Knotenpunkt wird nicht exportiert und kann somit nicht gelöscht oder geändert werden." />
        </DataTemplate>
        <DataTemplate x:Key="TempDynIndependent">
            <TextBlock Margin="5" Text="Ein Independent Channel wird selbst nicht dargestellt. Die darunter liegenden Parameterblöcke werden direkt in der Ansicht angezeigt." TextWrapping="Wrap" />
        </DataTemplate>
        <DataTemplate x:Key="TempDynParameter">
            <StackPanel>
                <HeaderedContentControl Header="Name">
                    <TextBox Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}" />
                </HeaderedContentControl>
                <HeaderedContentControl Header="Paremeter Ref">
                    <ComboBox ItemsSource="{Binding ElementName=VersionList, Path=SelectedItem.ParameterRefs}" SelectedItem="{Binding ParameterRefObject}" DisplayMemberPath="Name" />
                </HeaderedContentControl>
                <HeaderedContentControl Header="Parameter Name:">
                    <TextBlock Text="{Binding ParameterRefObject.ParameterObject.Name}" />
                </HeaderedContentControl>
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="TempDynComObject">
            <StackPanel>
                <HeaderedContentControl Header="Name">
                    <TextBox Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}" />
                </HeaderedContentControl>
                <HeaderedContentControl Header="Kommunikationsobjekt Ref">
                    <ComboBox ItemsSource="{Binding ElementName=VersionList, Path=SelectedItem.ComObjectRefs}" SelectedItem="{Binding ComObjectRefObject}" DisplayMemberPath="Name" />
                </HeaderedContentControl>
                <HeaderedContentControl Header="Kommunikationsobjekt Name:">
                    <TextBlock Text="{Binding ComObjectRefObject.ComObjectObject.Name}" />
                </HeaderedContentControl>
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="TempDynParaBlock">
            <StackPanel>
                <HeaderedContentControl Header="Name">
                    <TextBox Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}" />
                </HeaderedContentControl>
                <HeaderedContentControl Header="Text Parameter">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>

                        <CheckBox IsChecked="{Binding UseTextParameter}" VerticalAlignment="Center" />
                        <ComboBox Grid.Column="1" IsEnabled="{Binding UseTextParameter}" ItemsSource="{Binding ElementName=VersionList, Path=SelectedItem.ParameterRefs}" SelectedItem="{Binding ParameterRefObject, Mode=TwoWay}" DisplayMemberPath="Name" />
                    </Grid>
                </HeaderedContentControl>
                <Grid Visibility="{Binding UseTextParameter, Converter={StaticResource BoolToVis}, ConverterParameter=true}" Margin="5 0">
                    <TextBlock VerticalAlignment="Center">
                        <Run Text="ID:" />
                        <Run Text="{Binding Id}"/>
                    </TextBlock>
                    <Button Content="Zurücksetzen" HorizontalAlignment="Right" Click="ResetId" />
                </Grid>      
                <HeaderedContentControl Header="Text">
                    <StackPanel>
                        <CheckBox IsChecked="{Binding TranslationText}" Content="Übersetzung nicht exportieren" />
                        <DataGrid IsEnabled="{Binding UseTextParameter, Converter={StaticResource BoolNegate}}"  ItemsSource="{Binding Text}" AutoGenerateColumns="False" CanUserAddRows="False" CanUserSortColumns="False" CanUserResizeRows="False">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Sprache" Binding="{Binding Language.Text}" IsReadOnly="True" />
                                <DataGridTextColumn Header="Text" Binding="{Binding Text, UpdateSourceTrigger=PropertyChanged}" />
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                </HeaderedContentControl>
                
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="TempDynChannel">
            <StackPanel>
                <HeaderedContentControl Header="Name">
                    <TextBox Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}" />
                </HeaderedContentControl>
                <HeaderedContentControl Header="Nummer">
                    <TextBox Text="{Binding Number, UpdateSourceTrigger=PropertyChanged}" />
                </HeaderedContentControl>
                <HeaderedContentControl Header="Text Parameter">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>

                        <CheckBox IsChecked="{Binding UseTextParameter}" VerticalAlignment="Center" />
                        <ComboBox Grid.Column="1" IsEnabled="{Binding UseTextParameter}" ItemsSource="{Binding ElementName=VersionList, Path=SelectedItem.ParameterRefs}" SelectedItem="{Binding ParameterRefObject, Mode=TwoWay}" DisplayMemberPath="Name" />
                    </Grid>
                </HeaderedContentControl>
                <HeaderedContentControl Header="Text">
                    <StackPanel>
                        <CheckBox IsChecked="{Binding TranslationText}" Content="Übersetzung nicht exportieren" />
                        <DataGrid IsEnabled="{Binding UseTextParameter, Converter={StaticResource BoolNegate}}"  ItemsSource="{Binding Text}" AutoGenerateColumns="False" CanUserAddRows="False" CanUserSortColumns="False" CanUserResizeRows="False">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Sprache" Binding="{Binding Language.Text}" IsReadOnly="True" />
                                <DataGridTextColumn Header="Text" Binding="{Binding Text, UpdateSourceTrigger=PropertyChanged}" />
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                </HeaderedContentControl>
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="TempDynChoose">
            <StackPanel>
                <HeaderedContentControl Header="Name">
                    <TextBox Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}" />
                </HeaderedContentControl>
                <HeaderedContentControl Header="Paremeter Ref">
                    <ComboBox ItemsSource="{Binding ElementName=VersionList, Path=SelectedItem.ParameterRefs}" SelectedItem="{Binding ParameterRefObject}">
                        <ComboBox.ItemTemplate>
                            <DataTemplate>
                                <TextBlock>
                                    <Run Text="{Binding Name}" />
                                    <Run Text="{Binding ParameterObject.Name}" />
                                </TextBlock>
                            </DataTemplate>
                        </ComboBox.ItemTemplate>
                    </ComboBox>
                </HeaderedContentControl>
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="TempDynWhen">
            <StackPanel>
                <HeaderedContentControl Header="Name">
                    <TextBox Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}" />
                </HeaderedContentControl>
                <HeaderedContentControl Header="Bedingung">
                    <TextBox Text="{Binding Condition}" IsEnabled="{Binding IsDefault, Converter={StaticResource BoolNegate}}" />
                </HeaderedContentControl>
                <CheckBox IsChecked="{Binding IsDefault}" Content="Anzeigen, wenn alle anderen Bedingungen nicht erfüllt sind" />
                <TextBlock Margin="5">
                    <Run Text="Gleich: Wert mit Istgleichzeichen davor (Beispiel: =4)" />
                    <LineBreak />
                    <Run Text="Ungleich: Wert mit Istgleich- und Ausrufezeichen davor (Beispiel: !=4)" />
                    <LineBreak />
                    <Run Text="Liste: Werte durch Leerzeichen getrennt. (Beispiel: 1 2 3)" />
                    <LineBreak />
                    <Run Text="Größer als: > oder >= (Beispiel: >5)" />
                    <LineBreak />
                    <Run Text="Kleiner: &lt; oder &lt;= (Beispiel: &lt;=8)" />
                    <LineBreak />
                    <Run Text="" />
                    <LineBreak />
                </TextBlock>
            </StackPanel>
        </DataTemplate>
        
        
        
        <select:DynSelector x:Key="SelectorDyn"
            DPara="{StaticResource TempDynParameter}"
            DBlock="{StaticResource TempDynParaBlock}"
            DChoose="{StaticResource TempDynChoose}" 
            DWhen="{StaticResource TempDynWhen}"
            DMain="{StaticResource TempDynMain}"
            DIndependent="{StaticResource TempDynIndependent}"
            DChannel="{StaticResource TempDynChannel}"
            DCom="{StaticResource TempDynComObject}"
                            />
    </Window.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="auto" />
            <RowDefinition />
        </Grid.RowDefinitions>

        <Menu>
            <MenuItem Header="{x:Static p:Resources.menu_proj}">
                <MenuItem x:Name="MenuLoad" Header="{x:Static p:Resources.menu_proj_new}">
                    <MenuItem Header="Leer" Click="ClickNew" />
                    <Separator />
                </MenuItem>
                <MenuItem Header="{x:Static p:Resources.menu_proj_open}" Click="ClickOpen" />
                <MenuItem x:Name="MenuSave" IsEnabled="False" Header="{x:Static p:Resources.menu_proj_save}">
                    <MenuItem x:Name="MenuSaveBtn" Header="Speichern" Click="ClickSave" IsEnabled="false" />
                    <MenuItem Header="Speichern unter" Click="ClickSaveAs" />
                    <MenuItem Header="Speichern als Template" />
                </MenuItem>
                <MenuItem x:Name="MenuClose" IsEnabled="False" Header="{x:Static p:Resources.menu_proj_close}" />
            </MenuItem>
            <MenuItem x:Name="MenuImport" IsEnabled="False" Header="{x:Static p:Resources.menu_impo}">
                <MenuItem Header="{x:Static p:Resources.menu_impo_ets}" Click="ClickImport" />
                <MenuItem Header="{x:Static p:Resources.menu_impo_kaenx}" IsEnabled="False" />
            </MenuItem>
            <MenuItem x:Name="MenuLang" Header="{x:Static p:Resources.menu_lang}">
                <TextBlock Text="Please restart Application after changing language" TextWrapping="WrapWithOverflow" />
                <Separator />
                <MenuItem IsCheckable="True" Header="{x:Static p:Resources.menu_lang_default}" Tag="def" Click="ChangeLang" />
                <MenuItem IsCheckable="True" Header="Deutsch" Tag="de" Click="ChangeLang" />
                <MenuItem IsCheckable="True" Header="English" Tag="en" Click="ChangeLang" />
            </MenuItem>
        </Menu>

        <TabControl x:Name="TabsEdit" Grid.Row="1" Margin=" 0 10 0 0" IsEnabled="False" BorderThickness="0 0 0 4" Style="{StaticResource ResourceKey=TopTabControl}">

            <TabItem Header="{x:Static p:Resources.tabs_gen}" Style="{StaticResource TopTabItem}">
                <StackPanel>
                    <HeaderedContentControl Header="Manufacturer ID">
                        <TextBox Text="{Binding General.ManufacturerId, UpdateSourceTrigger=PropertyChanged}" />
                    </HeaderedContentControl>
                    <HeaderedContentControl Header="Projekt Name">
                        <TextBox Text="{Binding General.ProjectName, UpdateSourceTrigger=PropertyChanged}" />
                    </HeaderedContentControl>
                </StackPanel>
            </TabItem>

            <TabItem Header="{x:Static p:Resources.tabs_cat}" Style="{StaticResource TopTabItem}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition MaxWidth="250" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>

                    <TreeView Name="CatalogTree" ItemsSource="{Binding General.Catalog}">
                        <TreeView.Resources>
                            <HierarchicalDataTemplate DataType="{x:Type models:CatalogItem}" ItemsSource="{Binding Items}">
                                <StackPanel Orientation="Horizontal">
                                    <StackPanel.ContextMenu>
                                        <ContextMenu>
                                            <MenuItem Header="Unterpunkt hinzufügen" Click="ClickCatalogContext" IsEnabled="{Binding IsSection}" />
                                            <MenuItem Header="Entfernen" Click="ClickCatalogContextRemove" IsEnabled="{Binding Parent, Converter={StaticResource EmptyToBool}, ConverterParameter=true}" />
                                        </ContextMenu>
                                    </StackPanel.ContextMenu>
                                    <Image Source="/WpfTutorialSamples;component/Images/group.png" Margin="0,0,5,0" />
                                    <TextBlock Text="{Binding Name}" />
                                    <TextBlock Text=" [" Foreground="Blue" />
                                    <TextBlock Text="{Binding Items.Count}" Foreground="Blue" />
                                    <TextBlock Text="]" Foreground="Blue" />
                                </StackPanel>
                            </HierarchicalDataTemplate>
                        </TreeView.Resources>
                    </TreeView>

                    <StackPanel Grid.Column="1" DataContext="{Binding ElementName=CatalogTree, Path=SelectedItem}" IsEnabled="{Binding ElementName=CatalogTree, Path=SelectedItem, Converter={StaticResource EmptyToBool}, ConverterParameter=true}">
                        <StackPanel.Resources>
                            <Style TargetType="HeaderedContentControl">
                                <Setter Property="Margin" Value="5" />
                            </Style>
                            <Style TargetType="CheckBox">
                                <Setter Property="Margin" Value="5" />
                            </Style>
                            <Style TargetType="ComboBox">
                                <Setter Property="Margin" Value="5" />
                            </Style>
                        </StackPanel.Resources>
                        <HeaderedContentControl Header="Name" IsEnabled="{Binding Parent, Converter={StaticResource EmptyToBool}, ConverterParameter=true}">
                            <TextBox Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}" />
                        </HeaderedContentControl>
                        <HeaderedContentControl Header="Number">
                            <TextBox Text="{Binding Number, UpdateSourceTrigger=PropertyChanged}" />
                        </HeaderedContentControl>
                        <CheckBox Name="InCatalogSection" IsChecked="{Binding IsSection}" Content="Element ist eine Kategorie" IsEnabled="{Binding Items.Count, Converter={StaticResource EmptyListToBool}}" />
                        <HeaderedContentControl Header="Beschreibung" IsEnabled="{Binding ElementName=InCatalogSection, Path=IsChecked, Converter={StaticResource BoolNegate}}">
                            <TextBox Text="{Binding VisibleDescription, UpdateSourceTrigger=PropertyChanged}" />
                        </HeaderedContentControl>
                        <HeaderedContentControl Header="Hardware" IsEnabled="{Binding ElementName=InCatalogSection, Path=IsChecked, Converter={StaticResource BoolNegate}}">
                            <ComboBox Name="InCatalogHardware" Margin="0" ItemsSource="{Binding General.Hardware, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}" SelectedItem="{Binding Hardware, Mode=TwoWay}" DisplayMemberPath="Name"/>
                        </HeaderedContentControl>
                    </StackPanel>
                </Grid>
            </TabItem>

            <TabItem Header="{x:Static p:Resources.tabs_hard}" Style="{StaticResource TopTabItem}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="auto" />
                        <RowDefinition />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="150" />
                        <ColumnDefinition Width="150" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Button Content="Hinzufügen" Click="ClickAddHardware" Margin="0 0 1 2" />
                    <Button Grid.Column="1" Content="Löschen" Click="ClickRemoveHardware" Margin="1 0 0 2" IsEnabled="{Binding ElementName=HardwareList, Path=SelectedItem, Converter={StaticResource EmptyToBool}, ConverterParameter=true}" />

                    <ListView x:Name="HardwareList" Grid.Row="1" Grid.RowSpan="3" Grid.ColumnSpan="2" ItemsSource="{Binding General.Hardware}" DisplayMemberPath="Name" />

                    <TabControl Grid.RowSpan="2" Grid.Column="2" Style="{StaticResource TopTabControl}" DataContext="{Binding ElementName=HardwareList, Path=SelectedItem}"  IsEnabled="{Binding ElementName=HardwareList, Path=SelectedItem, Converter={StaticResource EmptyToBool}, ConverterParameter=true}">
                        <TabItem Header="Allgemein" Style="{StaticResource TopTabItem}">
                            <StackPanel DataContext="{Binding ElementName=HardwareList, Path=SelectedItem}" IsEnabled="{Binding ElementName=HardwareList, Path=SelectedItem, Converter={StaticResource EmptyToBool}, ConverterParameter=true}">
                                <StackPanel.Resources>
                                    <Style TargetType="HeaderedContentControl">
                                        <Setter Property="Margin" Value="5" />
                                    </Style>
                                    <Style TargetType="CheckBox">
                                        <Setter Property="Margin" Value="5" />
                                    </Style>
                                    <Style TargetType="ComboBox">
                                        <Setter Property="Margin" Value="5" />
                                    </Style>
                                </StackPanel.Resources>
                                <HeaderedContentControl Header="Name">
                                    <TextBox Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}" />
                                </HeaderedContentControl>
                                <HeaderedContentControl Header="Seriennummer">
                                    <TextBox Text="{Binding SerialNumber, UpdateSourceTrigger=PropertyChanged}" />
                                </HeaderedContentControl>
                                <HeaderedContentControl Header="Version">
                                    <TextBox Text="{Binding Version, UpdateSourceTrigger=PropertyChanged}" />
                                </HeaderedContentControl>
                                <HeaderedContentControl Header="Busstrom">
                                    <TextBox Text="{Binding BusCurrent, UpdateSourceTrigger=PropertyChanged}" />
                                </HeaderedContentControl>
                                <CheckBox IsChecked="{Binding HasIndividualAddress, Mode=TwoWay}" Content="Hat eine Individuelle Adresse" />
                                <CheckBox IsChecked="{Binding IsPowerSupply, Mode=TwoWay}" Content="Gerät ist eine Spannungsversorgung" />
                                <CheckBox IsChecked="{Binding IsCoppler, Mode=TwoWay}" Content="Gerät ist ein Koppler" />
                                <CheckBox IsChecked="{Binding IsIpEnabled, Mode=TwoWay}" Content="Gerät kann KNXnet/IP" />

                                <CheckBox IsChecked="{Binding HasApplicationProgram, Mode=TwoWay}" Content="Hat ein Applikationsprogramm" />
                                <CheckBox IsChecked="{Binding HasApplicationProgram2, Mode=TwoWay}" Content="Hat ein zweites Applikationsprogramm" />
                            </StackPanel>
                        </TabItem>

                        <TabItem Header="Geräte" Style="{StaticResource TopTabItem}">
                            <DataGrid Grid.Row="1" ItemsSource="{Binding Devices}" AutoGenerateColumns="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Name" Binding="{Binding Name}"/>
                                    <DataGridTextColumn Header="Text" Binding="{Binding Text}" />
                                    <DataGridTextColumn Header="Beschreibung" Binding="{Binding Description}" />
                                    <DataGridTextColumn Header="Bestellnummer" Binding="{Binding OrderNumber}" />
                                    <DataGridCheckBoxColumn Header="Ist REG" Binding="{Binding IsRailMounted}" />
                                </DataGrid.Columns>
                            </DataGrid>
                        </TabItem>

                        <TabItem Header="Applikationen" Style="{StaticResource TopTabItem}">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="auto" />
                                    <RowDefinition />
                                </Grid.RowDefinitions>

                                <StackPanel Orientation="Horizontal">
                                    <ComboBox Width="150" Name="InHardApp" Margin="2" ItemsSource="{Binding General.Applications, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}" DisplayMemberPath="Name" />
                                    <Button Content="Hinzufügen" Click="ClickAddHardApp" Margin="2" />
                                    <Button Content="Entfernen" Margin="2" Click="ClickRemoveDeviceApp" IsEnabled="{Binding ElementName=DeviceAppList, Path=SelectedItem, Converter={StaticResource EmptyToBool}, ConverterParameter=true}" />
                                </StackPanel>

                                <ListBox Name="DeviceAppList" Grid.Row="1" ItemsSource="{Binding Apps}" DisplayMemberPath="Name" />
                            </Grid>
                        </TabItem>
                    </TabControl>

                </Grid>


                
            </TabItem>

            <TabItem Header="{x:Static p:Resources.tabs_apps}" Style="{StaticResource TopTabItem}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="auto" />
                        <RowDefinition />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="150" />
                        <ColumnDefinition Width="150" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Button Content="Hinzufügen" Click="ClickAddApp" Margin="0 0 1 2" />
                    <Button Grid.Column="1" Content="Löschen" Click="ClickRemoveApp" Margin="1 0 0 2" IsEnabled="{Binding ElementName=AppList, Path=SelectedItem, Converter={StaticResource EmptyToBool}, ConverterParameter=true}" />

                    <ListView x:Name="AppList" Grid.Row="1" Grid.ColumnSpan="2" ItemsSource="{Binding General.Applications}" DisplayMemberPath="NameText" />

                    <Grid Grid.Column="2" Grid.RowSpan="2" DataContext="{Binding ElementName=AppList, Path=SelectedItem}" IsEnabled="{Binding ElementName=AppList, Path=SelectedItem, Converter={StaticResource EmptyToBool}, ConverterParameter=true}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="auto" />
                            <RowDefinition Height="auto" />
                            <RowDefinition Height="auto" />
                            <RowDefinition />
                        </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.ColumnSpan="3">
                            <StackPanel.Resources>
                                <Style TargetType="HeaderedContentControl">
                                    <Setter Property="Margin" Value="5" />
                                </Style>
                                <Style TargetType="CheckBox">
                                    <Setter Property="Margin" Value="5" />
                                </Style>
                                <Style TargetType="ComboBox">
                                    <Setter Property="Margin" Value="5" />
                                </Style>
                                <Style TargetType="Button">
                                    <Setter Property="Margin" Value="5" />
                                </Style>
                            </StackPanel.Resources>
                            <HeaderedContentControl Header="Name">
                                <TextBox Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}" />
                            </HeaderedContentControl>
                            <HeaderedContentControl Header="Nummer">
                                <TextBox Text="{Binding Number, UpdateSourceTrigger=PropertyChanged}" />
                            </HeaderedContentControl>
                            <HeaderedContentControl Header="BCU">
                                <ComboBox SelectedItem="{Binding Mask, Mode=TwoWay}" Margin="0" DisplayMemberPath="Id" IsEnabled="{Binding Versions.Count, Converter={StaticResource EmptyListToBool}}" ItemsSource="{Binding BCUs, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}" />
                            </HeaderedContentControl>

                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>

                                <TextBlock HorizontalAlignment="Center">
                                    <Run Text="Speicherart:" />
                                    <Run Text="{Binding Mask.Memory}" />
                                </TextBlock>

                                <TextBlock Grid.Column="1" HorizontalAlignment="Center">
                                    <Run Text="Ladeprocedure:" />
                                    <Run Text="{Binding Mask.Procedure}" />
                                </TextBlock>
                            </Grid>
                        </StackPanel>


                        <Separator Grid.Row="1" Grid.ColumnSpan="3" Margin="0 10 0 4" />

                        <Button Grid.Row="2" Content="Version hinzufügen" Click="ClickAddVersion" Margin="5 5 2.5 2" IsEnabled="{Binding Mask, Converter={StaticResource EmptyToBool}, ConverterParameter=true}" />
                        <Button Grid.Row="2" Grid.Column="1" Content="Version Löschen" Click="ClickRemoveVersion" Margin="2.5 5 5 2" IsEnabled="{Binding ElementName=VersionList, Path=SelectedItem, Converter={StaticResource EmptyToBool}, ConverterParameter=true}" />
                        <Button Grid.Row="2" Grid.Column="2" Content="Version Kopieren" Click="ClickCopyVersion" Margin="2.5 5 5 2" IsEnabled="{Binding ElementName=VersionList, Path=SelectedItem, Converter={StaticResource EmptyToBool}, ConverterParameter=true}" />

                        <ListView x:Name="VersionList" Grid.Row="3" Grid.ColumnSpan="3" ItemsSource="{Binding Versions}" DisplayMemberPath="NameText" Margin="5 5 5 0" />
                    </Grid>
                </Grid>
            </TabItem>

            <TabItem DataContext="{Binding ElementName=VersionList, Path=SelectedItem}" Style="{StaticResource TopTabItem}" IsEnabled="{Binding ElementName=VersionList, Path=SelectedItem, Converter={StaticResource EmptyToBool}, ConverterParameter=true}">
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <!--<TextBlock FontSize="18" Text="{Binding ElementName=AppList, Path=SelectedItem.Name}" Margin="0 0 5 0" />-->
                        <TextBlock FontSize="18" Text="{Binding NameText}" />
                    </StackPanel>
                </TabItem.Header>

                <TabControl TabStripPlacement="Left" Style="{StaticResource LeftTabControl}">
                    <TabItem Header="Allgemein" BorderThickness="0 0 4 0" Style="{StaticResource LeftTabItem}">
                        <StackPanel>
                            <StackPanel.Resources>
                                <Style TargetType="HeaderedContentControl">
                                    <Setter Property="Margin" Value="5" />
                                    <Setter Property="IsTabStop" Value="false" />
                                </Style>
                                <Style TargetType="CheckBox">
                                    <Setter Property="Margin" Value="5" />
                                </Style>
                                <Style TargetType="ComboBox">
                                    <Setter Property="Margin" Value="5" />
                                </Style>
                                <Style TargetType="Button">
                                    <Setter Property="Margin" Value="5" />
                                </Style>
                                <Style TargetType="ListView">
                                    <Setter Property="Margin" Value="5" />
                                </Style>
                            </StackPanel.Resources>
                            
                            <HeaderedContentControl Header="Version">
                                <TextBox Text="{Binding Number, UpdateSourceTrigger=PropertyChanged}" />
                            </HeaderedContentControl>

                            <HeaderedContentControl Header="Name">
                                <TextBox Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}" />
                            </HeaderedContentControl>
                            <HeaderedContentControl Header="Text">
                                <DataGrid ItemsSource="{Binding Text}" AutoGenerateColumns="False" CanUserAddRows="False" CanUserSortColumns="False" CanUserResizeRows="False">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Sprache" Binding="{Binding Language.Text}" IsReadOnly="True" />
                                        <DataGridTextColumn Header="Text" Binding="{Binding Text, UpdateSourceTrigger=PropertyChanged}" />
                                    </DataGrid.Columns>
                                </DataGrid>
                            </HeaderedContentControl>
                            <HeaderedContentControl Header="Namespace Version">
                                <ComboBox x:Name="NamespaceSelection" DisplayMemberPath="DisplayName" SelectedValue="{Binding NamespaceVersion}" SelectedIndex="3" SelectedValuePath="Number">
                                    <!--<ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding DisplayName}" IsEnabled="{Binding IsEnabled}" />
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>-->
                                    <ComboBox.ItemContainerStyle>
                                        <Style TargetType="{x:Type ComboBoxItem}">
                                            <Setter Property="IsEnabled" Value="{Binding IsEnabled}"/>
                                        </Style>
                                    </ComboBox.ItemContainerStyle>
                                </ComboBox>
                            </HeaderedContentControl>



                            <HeaderedContentControl Header="Sprachen">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition MaxWidth="300" />
                                    </Grid.ColumnDefinitions>
                                    
                                    <ListBox x:Name="SupportedLanguages" ItemsSource="{Binding Languages}" DisplayMemberPath="Text" />
                                    
                                    <StackPanel Grid.Column="1">
                                        <HeaderedContentControl Header="Bearbeiten">
                                            <StackPanel>
                                                <ComboBox x:Name="LanguagesList" DisplayMemberPath="Text">
                                                    <models:Language Text="Tschechisch" CultureCode="cs-CZ" />
                                                    <models:Language Text="Dänisch" CultureCode="da-DK" />
                                                    <models:Language Text="Deutsch" CultureCode="de-DE" />
                                                    <models:Language Text="Griechisch" CultureCode="el-GR" />
                                                    <models:Language Text="Englisch" CultureCode="en-US" />
                                                    <models:Language Text="Spanisch" CultureCode="es-ES" />
                                                    <models:Language Text="Finnisch" CultureCode="fi-FI" />
                                                    <models:Language Text="Französisch" CultureCode="fr-FR" />
                                                    <models:Language Text="Ungarisch" CultureCode="hu-HU" />
                                                    <models:Language Text="Isländisch" CultureCode="is-IS" />
                                                    <models:Language Text="Italienisch" CultureCode="it-IT" />
                                                    <models:Language Text="Japanisch" CultureCode="ja-JP" />
                                                    <models:Language Text="Norwegisch" CultureCode=" nb-NO" />
                                                    <models:Language Text="Niederländisch" CultureCode="nl-NL" />
                                                    <models:Language Text="Polnisch" CultureCode="pl-PL" />
                                                    <models:Language Text="Portugisisch" CultureCode="pt-PT" />
                                                    <models:Language Text="Rumänisch" CultureCode="ro-RO" />
                                                    <models:Language Text="Russisch" CultureCode="ru-RU" />
                                                    <models:Language Text="Slovakisch" CultureCode="sk-SK" />
                                                    <models:Language Text="Slovenisch" CultureCode="sl-SI" />
                                                    <models:Language Text="Schwedisch" CultureCode="sv-SE" />
                                                    <models:Language Text="Türkisch" CultureCode="tr-TR" />
                                                    <models:Language Text="Chinesisch" CultureCode="zh-CN" />
                                                </ComboBox>
                                                <Button Content="Hinzufügen" Click="ClickAddLanguage" />
                                                <Button  Content="Entfernen" Click="ClickRemoveLanguage" />
                                            </StackPanel>
                                        </HeaderedContentControl>
                                        <HeaderedContentControl Header="Standard Sprache">
                                            <ComboBox ItemsSource="{Binding Languages}" SelectedValue="{Binding DefaultLanguage}" SelectedValuePath="CultureCode" DisplayMemberPath="Text"></ComboBox>
                                        </HeaderedContentControl>
                                    </StackPanel>
                                </Grid>
                            </HeaderedContentControl>

                            
                            <CheckBox IsChecked="{Binding IsMemSizeAuto}" Content="Automatisch Speicher berechnen beim Veröffentlichen" />
                            <CheckBox IsChecked="{Binding IsParameterRefAuto}" Content="Parameter Refs automatisch berechnen" />
                            <CheckBox IsChecked="{Binding IsComObjectRefAuto}" Content="KO Refs automatisch berechnen" />
                            <CheckBox IsChecked="{Binding IsUnionActive}" Content="Unions aktivieren" />
                            <CheckBox IsChecked="{Binding IsModulesActive}" Content="ModuleDefines aktivieren" />

                        </StackPanel>
                    </TabItem>

                    <TabItem Header="Speicher" Style="{StaticResource LeftTabItem}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150" />
                                <ColumnDefinition Width="150" />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="auto" />
                                <RowDefinition />
                            </Grid.RowDefinitions>

                            <Button Content="Hinzufügen" Click="ClickAddMemory" Margin="0 0 1 2" />
                            <Button Grid.Column="1" Content="Löschen" Click="ClickRemoveMemory" Margin="1 0 0 2" />

                            <ListView x:Name="ListMemories" Grid.Row="1" Grid.ColumnSpan="2" ItemsSource="{Binding Memories}" DisplayMemberPath="Name" />

                            <ScrollViewer Grid.Column="3" Grid.RowSpan="2">
                                <StackPanel Margin="5" DataContext="{Binding ElementName=ListMemories, Path=SelectedItem}" IsEnabled="{Binding Converter={StaticResource EmptyToBool}, ConverterParameter=true}">
                                    <StackPanel.Resources>
                                        <ObjectDataProvider x:Key="dataFromEnum" MethodName="GetValues" ObjectType="{x:Type System:Enum}">
                                            <ObjectDataProvider.MethodParameters>
                                                <x:Type TypeName="models:MemoryTypes"/>
                                            </ObjectDataProvider.MethodParameters>
                                        </ObjectDataProvider>
                                        <Style TargetType="HeaderedContentControl">
                                            <Setter Property="Margin" Value="5" />
                                            <Setter Property="IsTabStop" Value="false" />
                                        </Style>
                                        <Style TargetType="CheckBox">
                                            <Setter Property="Margin" Value="5" />
                                        </Style>
                                        <Style TargetType="ComboBox">
                                            <Setter Property="Margin" Value="5" />
                                        </Style>
                                        <Style TargetType="Button">
                                            <Setter Property="Margin" Value="5" />
                                        </Style>
                                        <Style TargetType="ListView">
                                            <Setter Property="Margin" Value="5" />
                                        </Style>
                                    </StackPanel.Resources>

                                    <HeaderedContentControl Header="Name">
                                        <TextBox Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}"/>
                                    </HeaderedContentControl>
                                    <HeaderedContentControl Header="Adresse" Visibility="{Binding ElementName=AppList, Path=SelectedItem.Mask.Memory, Converter={StaticResource EnumToVis}, ConverterParameter=Absolute}">
                                        <TextBox Text="{Binding Address, UpdateSourceTrigger=PropertyChanged}"/>
                                    </HeaderedContentControl>
                                    <CheckBox Content="Größe automatisch anordnen"  IsChecked="{Binding IsAutoSize}" />
                                    <HeaderedContentControl Header="Größe" IsEnabled="{Binding IsAutoSize, Converter={StaticResource BoolNegate}}">
                                        <TextBox Text="{Binding Size, UpdateSourceTrigger=PropertyChanged}" />
                                    </HeaderedContentControl>
                                    <HeaderedContentControl Header="Offset" Visibility="{Binding ElementName=AppList, Path=SelectedItem.Mask.Memory, Converter={StaticResource EnumToVis}, ConverterParameter=Relative}">
                                        <TextBox Text="{Binding Offset, UpdateSourceTrigger=PropertyChanged}"/>
                                    </HeaderedContentControl>
                                    <CheckBox Content="Parameter automatisch anordnen"  IsChecked="{Binding IsAutoPara}" />

                                    <Button Content="Heatmap berechnen" Click="ClickCalcHeatmap" />
                                    <Image Name="OutHeatmap" MaxWidth="500" />
                                </StackPanel>
                            </ScrollViewer>
                        </Grid>
                    </TabItem>

                    <TabItem Header="ParameterTypes" Style="{StaticResource LeftTabItem}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150" />
                                <ColumnDefinition Width="150" />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="auto" />
                                <RowDefinition />
                            </Grid.RowDefinitions>

                            <Button Content="Hinzufügen" Click="ClickAddParamType" Margin="0 0 1 2" />
                            <Button Grid.Column="1" Content="Löschen" Click="ClickRemoveParamType" Margin="1 0 0 2" />

                            <ListView x:Name="ListParamTypes" Grid.Row="1" Grid.ColumnSpan="2" ItemsSource="{Binding ParameterTypes}" DisplayMemberPath="Name" />

                            <StackPanel Grid.Column="3" Grid.RowSpan="2" Margin="5" DataContext="{Binding ElementName=ListParamTypes, Path=SelectedItem}" IsEnabled="{Binding Converter={StaticResource EmptyToBool}, ConverterParameter=true}">
                                <StackPanel.Resources>
                                    <ObjectDataProvider x:Key="dataFromEnum" MethodName="GetValues" ObjectType="{x:Type System:Enum}">
                                        <ObjectDataProvider.MethodParameters>
                                            <x:Type TypeName="models:ParameterTypes"/>
                                        </ObjectDataProvider.MethodParameters>
                                    </ObjectDataProvider>
                                    <Style TargetType="HeaderedContentControl">
                                        <Setter Property="Margin" Value="5" />
                                        <Setter Property="IsTabStop" Value="false" />
                                    </Style>
                                    <Style TargetType="CheckBox">
                                        <Setter Property="Margin" Value="5" />
                                    </Style>
                                    <Style TargetType="ComboBox">
                                        <Setter Property="Margin" Value="5" />
                                    </Style>
                                    <Style TargetType="Button">
                                        <Setter Property="Margin" Value="5" />
                                    </Style>
                                    <Style TargetType="ListView">
                                        <Setter Property="Margin" Value="5" />
                                    </Style>
                                </StackPanel.Resources>
                                    
                                <HeaderedContentControl Header="Name">
                                    <TextBox Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}"/>
                                </HeaderedContentControl>
                                <HeaderedContentControl Header="Type">
                                    <ComboBox Margin="0 5" ItemsSource="{Binding Source={StaticResource dataFromEnum}}" SelectedItem="{Binding Type, Mode=TwoWay}" />
                                </HeaderedContentControl>
                                
                                <StackPanel Visibility="{Binding Type, Converter={StaticResource EnumToVisNeg}, ConverterParameter=None-IpAddress-Picture}">
                                    <CheckBox IsChecked="{Binding IsSizeAuto}" Content="Größe automatisch" IsEnabled="False" />
                                    <HeaderedContentControl Header="Größe in Bits" Visibility="{Binding IsSizeAuto, Converter={StaticResource BoolToVis}, ConverterParameter=true}">
                                        <TextBox Text="{Binding SizeInBit, UpdateSourceTrigger=PropertyChanged}"/>
                                    </HeaderedContentControl>
                                </StackPanel>


                                

                                <Grid Margin="5 20 5 5"  Visibility="{Binding Type, Converter={StaticResource EnumToVis}, ConverterParameter=Enum}">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="auto" />
                                    </Grid.ColumnDefinitions>

                                    <DataGrid x:Name="ptypeList" ItemsSource="{Binding Enums}" MaxHeight="100" AutoGenerateColumns="False" CanUserAddRows="False">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="*" />
                                            <DataGridTextColumn Header="Wert" Binding="{Binding Value}" MinWidth="50" />
                                            <DataGridCheckBoxColumn Header="Übersetzen" Binding="{Binding Translate}" MinWidth="50" />
                                        </DataGrid.Columns>
                                    </DataGrid>
                                    <Button Grid.Column="1" Content="+" Width="30" Click="ClickAddParamEnum" />
                                </Grid>

                                <DataGrid ItemsSource="{Binding SelectedItem.Text, ElementName=ptypeList}" Margin="5" AutoGenerateColumns="False" CanUserDeleteRows="False" CanUserAddRows="False" CanUserSortColumns="False" CanUserResizeRows="False" Visibility="{Binding Type, Converter={StaticResource EnumToVis}, ConverterParameter=Enum}">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Sprache" Binding="{Binding Language.Text}" IsReadOnly="True" />
                                        <DataGridTextColumn Header="Text" Binding="{Binding Text, UpdateSourceTrigger=PropertyChanged}" />
                                    </DataGrid.Columns>
                                </DataGrid>
                                    
                                <StackPanel Visibility="{Binding Type, Converter={StaticResource EnumToVis}, ConverterParameter=NumberUInt-NumberInt-Float9}">
                                    <HeaderedContentControl Header="Min">
                                        <TextBox Text="{Binding Min, UpdateSourceTrigger=PropertyChanged}"/>
                                    </HeaderedContentControl>
                                    <HeaderedContentControl Header="Max">
                                        <TextBox Text="{Binding Max, UpdateSourceTrigger=PropertyChanged}"/>
                                    </HeaderedContentControl>
                                </StackPanel>
                            </StackPanel>
                        </Grid>
                    </TabItem>

                    <TabItem Header="Unions" Visibility="{Binding IsUnionActive, Converter={StaticResource BoolToVis}}" Style="{StaticResource LeftTabItem}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="auto" />
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150" />
                                <ColumnDefinition Width="150" />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <Button Content="Hinzufügen" Click="ClickAddUnion" Margin="0 0 1 2" />
                            <Button Grid.Column="1" Content="Löschen" Click="ClickRemoveUnion" Margin="1 0 0 2" />

                            <ListView x:Name="UnionList" Grid.Row="1" Grid.ColumnSpan="2" ItemsSource="{Binding Unions}" DisplayMemberPath="Name" />

                            <ScrollViewer Grid.Column="3" Grid.RowSpan="2" DataContext="{Binding ElementName=UnionList, Path=SelectedItem}" IsEnabled="{Binding Converter={StaticResource EmptyToBool}, ConverterParameter=true}">
                                <StackPanel Margin="5">
                                    <StackPanel.Resources>
                                        <ObjectDataProvider x:Key="dataFromEnum" MethodName="GetValues" ObjectType="{x:Type System:Enum}">
                                            <ObjectDataProvider.MethodParameters>
                                                <x:Type TypeName="models:ParamAccess"/>
                                            </ObjectDataProvider.MethodParameters>
                                        </ObjectDataProvider>
                                        <ObjectDataProvider x:Key="dataSave" MethodName="GetValues" ObjectType="{x:Type System:Enum}">
                                            <ObjectDataProvider.MethodParameters>
                                                <x:Type TypeName="models:ParamSave"/>
                                            </ObjectDataProvider.MethodParameters>
                                        </ObjectDataProvider>
                                        <Style TargetType="HeaderedContentControl">
                                            <Setter Property="Margin" Value="5" />
                                            <Setter Property="IsTabStop" Value="false" />
                                        </Style>
                                        <Style TargetType="CheckBox">
                                            <Setter Property="Margin" Value="5" />
                                        </Style>
                                        <Style TargetType="ComboBox">
                                            <Setter Property="Margin" Value="0 5" />
                                        </Style>
                                        <Style TargetType="Button">
                                            <Setter Property="Margin" Value="5" />
                                        </Style>
                                        <Style TargetType="ListView">
                                            <Setter Property="Margin" Value="5" />
                                        </Style>
                                    </StackPanel.Resources>

                                    <TextBlock Margin="5 0" VerticalAlignment="Center">
                                        <Run Text="UID:" />
                                        <Run Text="{Binding UId}"/>
                                    </TextBlock>

                                    <HeaderedContentControl Header="Name">
                                        <TextBox Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}"/>
                                    </HeaderedContentControl>
                                    <HeaderedContentControl Header="SizeInBit">
                                        <TextBox Text="{Binding SizeInBit, UpdateSourceTrigger=PropertyChanged}"/>
                                    </HeaderedContentControl>

                                    <HeaderedContentControl Header="Speicherort">
                                        <ComboBox ItemsSource="{Binding Source={StaticResource dataSave}}" SelectedItem="{Binding SavePath, Mode=TwoWay}" />
                                    </HeaderedContentControl>

                                    <StackPanel Visibility="{Binding SavePath, Converter={StaticResource EnumToVis}, ConverterParameter=Memory}">
                                        <HeaderedContentControl Header="Speicher auswählen">
                                            <ComboBox ItemsSource="{Binding ElementName=VersionList, Path=SelectedItem.Memories}" SelectedItem="{Binding MemoryObject, Mode=TwoWay}" DisplayMemberPath="Name" />
                                        </HeaderedContentControl>
                                        <HeaderedContentControl Header="Offset">
                                            <TextBox Text="{Binding Offset, UpdateSourceTrigger=PropertyChanged}"/>
                                        </HeaderedContentControl>
                                        <HeaderedContentControl Header="Bit Offset">
                                            <TextBox Text="{Binding OffsetBit, UpdateSourceTrigger=PropertyChanged}"/>
                                        </HeaderedContentControl>
                                    </StackPanel>

                                    <StackPanel Visibility="{Binding SavePath, Converter={StaticResource EnumToVis}, ConverterParameter=Property}">
                                        <TextBlock Text="Properties werden noch nicht unterstütz" />
                                    </StackPanel>
                                </StackPanel>
                            </ScrollViewer>
                        </Grid>
                    </TabItem>

                    <TabItem Header="Module" Visibility="{Binding IsModulesActive, Converter={StaticResource BoolToVis}}" Style="{StaticResource LeftTabItem}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="auto" />
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150" />
                                <ColumnDefinition Width="150" />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <Button Content="Hinzufügen" Click="ClickAddModule" Margin="0 0 1 2" />
                            <Button Grid.Column="1" Content="Löschen" Click="ClickRemoveModule" Margin="1 0 0 2" />

                            <ListView x:Name="ModuleList" Grid.Row="1" Grid.ColumnSpan="2" ItemsSource="{Binding Modules}" DisplayMemberPath="Name" />

                            <TabControl Grid.RowSpan="2" Grid.Column="3" TabStripPlacement="Left" Style="{StaticResource LeftTabControl}"  DataContext="{Binding ElementName=ModuleList, Path=SelectedItem}" IsEnabled="{Binding Converter={StaticResource EmptyToBool}, ConverterParameter=true}">
                                <TabItem Header="Allgemein" Style="{StaticResource LeftTabItem2}"> 
                                    <ScrollViewer>
                                        <StackPanel Margin="5">
                                            <StackPanel.Resources>
                                                <ObjectDataProvider x:Key="dataFromEnum" MethodName="GetValues" ObjectType="{x:Type System:Enum}">
                                                    <ObjectDataProvider.MethodParameters>
                                                        <x:Type TypeName="models:ParamAccess"/>
                                                    </ObjectDataProvider.MethodParameters>
                                                </ObjectDataProvider>
                                                <ObjectDataProvider x:Key="dataSave" MethodName="GetValues" ObjectType="{x:Type System:Enum}">
                                                    <ObjectDataProvider.MethodParameters>
                                                        <x:Type TypeName="models:ParamSave"/>
                                                    </ObjectDataProvider.MethodParameters>
                                                </ObjectDataProvider>
                                                <Style TargetType="HeaderedContentControl">
                                                    <Setter Property="Margin" Value="5" />
                                                    <Setter Property="IsTabStop" Value="false" />
                                                </Style>
                                                <Style TargetType="CheckBox">
                                                    <Setter Property="Margin" Value="5" />
                                                </Style>
                                                <Style TargetType="ComboBox">
                                                    <Setter Property="Margin" Value="0 5" />
                                                </Style>
                                                <Style TargetType="Button">
                                                    <Setter Property="Margin" Value="5" />
                                                </Style>
                                                <Style TargetType="ListView">
                                                    <Setter Property="Margin" Value="5" />
                                                </Style>
                                            </StackPanel.Resources>

                                            <TextBlock Margin="5 0" VerticalAlignment="Center">
                                                <Run Text="UID:" />
                                                <Run Text="{Binding UId}"/>
                                            </TextBlock>

                                            <Grid Margin="5 0">
                                                <TextBlock VerticalAlignment="Center">
                                                    <Run Text="ID:" />
                                                    <Run Text="{Binding Id}"/>
                                                </TextBlock>
                                                <Button Content="Zurücksetzen" HorizontalAlignment="Right" Click="ResetId" />
                                            </Grid>
                                            
                                            <HeaderedContentControl Header="Name">
                                                <TextBox Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}"/>
                                            </HeaderedContentControl>
                                        </StackPanel>
                                    </ScrollViewer>
                                </TabItem>
                                <TabItem Header="Argumente" Style="{StaticResource LeftTabItem2}"> 

                                </TabItem>
                                <TabItem Header="Parameter" Style="{StaticResource LeftTabItem2}">

                                </TabItem>
                                <TabItem Header="Parameter Refs" Style="{StaticResource LeftTabItem2}">

                                </TabItem>
                                <TabItem Header="ComObjekte" Style="{StaticResource LeftTabItem2}">

                                </TabItem>
                                <TabItem Header="ComObjekte Refs" Style="{StaticResource LeftTabItem2}">

                                </TabItem>
                            </TabControl>
                        </Grid>
                    </TabItem>

                    <TabItem Header="Parameter" Style="{StaticResource LeftTabItem}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="auto" />
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150" />
                                <ColumnDefinition Width="150" />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <Button Content="Hinzufügen" Click="ClickAddParam" Margin="0 0 1 2" />
                            <Button Grid.Column="1" Content="Löschen" Click="ClickRemoveParam" Margin="1 0 0 2" />

                            <ListView x:Name="ParamList" Grid.Row="1" Grid.ColumnSpan="2" ItemsSource="{Binding Parameters}" DisplayMemberPath="Name" />

                            <ScrollViewer Grid.Column="3" Grid.RowSpan="2" DataContext="{Binding ElementName=ParamList, Path=SelectedItem}" IsEnabled="{Binding Converter={StaticResource EmptyToBool}, ConverterParameter=true}">
                                <StackPanel Margin="5">
                                    <StackPanel.Resources>
                                        <ObjectDataProvider x:Key="dataFromEnum" MethodName="GetValues" ObjectType="{x:Type System:Enum}">
                                            <ObjectDataProvider.MethodParameters>
                                                <x:Type TypeName="models:ParamAccess"/>
                                            </ObjectDataProvider.MethodParameters>
                                        </ObjectDataProvider>
                                        <ObjectDataProvider x:Key="dataSave" MethodName="GetValues" ObjectType="{x:Type System:Enum}">
                                            <ObjectDataProvider.MethodParameters>
                                                <x:Type TypeName="models:ParamSave"/>
                                            </ObjectDataProvider.MethodParameters>
                                        </ObjectDataProvider>
                                        <Style TargetType="HeaderedContentControl">
                                            <Setter Property="Margin" Value="5" />
                                            <Setter Property="IsTabStop" Value="false" />
                                        </Style>
                                        <Style TargetType="CheckBox">
                                            <Setter Property="Margin" Value="5" />
                                        </Style>
                                        <Style TargetType="ComboBox">
                                            <Setter Property="Margin" Value="0 5" />
                                        </Style>
                                        <Style TargetType="Button">
                                            <Setter Property="Margin" Value="5" />
                                        </Style>
                                        <Style TargetType="ListView">
                                            <Setter Property="Margin" Value="5" />
                                        </Style>
                                    </StackPanel.Resources>

                                    <TextBlock Margin="5 0" VerticalAlignment="Center">
                                        <Run Text="UID:" />
                                        <Run Text="{Binding UId}"/>
                                    </TextBlock>

                                    <Grid Margin="5 0">
                                        <TextBlock VerticalAlignment="Center">
                                            <Run Text="ID:" />
                                            <Run Text="{Binding Id}"/>
                                        </TextBlock>
                                        <Button Content="Zurücksetzen" HorizontalAlignment="Right" Click="ResetId" />
                                    </Grid>
                                    
                                    <HeaderedContentControl Header="Name">
                                        <TextBox Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}"/>
                                    </HeaderedContentControl>
                                    <HeaderedContentControl Header="Text">
                                        <StackPanel>
                                            <CheckBox IsChecked="{Binding TranslationText}" Content="Übersetzung nicht exportieren" />
                                            <DataGrid ItemsSource="{Binding Text}" AutoGenerateColumns="False" CanUserDeleteRows="False" CanUserAddRows="False" CanUserSortColumns="False" CanUserResizeRows="False">
                                                <DataGrid.Columns>
                                                    <DataGridTextColumn Header="Sprache" Binding="{Binding Language.Text}" IsReadOnly="True" />
                                                    <DataGridTextColumn Header="Text" Binding="{Binding Text, UpdateSourceTrigger=PropertyChanged}" />
                                                </DataGrid.Columns>
                                            </DataGrid>
                                        </StackPanel>
                                    </HeaderedContentControl>
                                    <HeaderedContentControl Header="Wert">
                                        <TextBox Text="{Binding Value, UpdateSourceTrigger=PropertyChanged}"/>
                                    </HeaderedContentControl>
                                    <HeaderedContentControl Header="Zugriff">
                                        <ComboBox ItemsSource="{Binding Source={StaticResource dataFromEnum}}" SelectedItem="{Binding Access, Mode=TwoWay}" />
                                    </HeaderedContentControl>
                                    <HeaderedContentControl Header="Suffix">
                                        <TextBox Text="{Binding Suffix, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    </HeaderedContentControl>

                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition />
                                            <ColumnDefinition Width="auto" />
                                        </Grid.ColumnDefinitions>
                                        <HeaderedContentControl Header="Type">
                                            <ComboBox ItemsSource="{Binding ElementName=VersionList, Path=SelectedItem.ParameterTypes}" DisplayMemberPath="Name" SelectedItem="{Binding ParameterTypeObject}" />
                                        </HeaderedContentControl>

                                        <TextBlock Grid.Column="1" HorizontalAlignment="Right" VerticalAlignment="Bottom" Margin="0 0 10 14">
                                        <Run Text="{Binding ParameterTypeObject.SizeInBit}" />
                                        <Run Text="Bit" />
                                        </TextBlock>
                                    </Grid>

                                    <HeaderedContentControl Header="Union zugehörigkeit">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="auto" />
                                                <ColumnDefinition />
                                            </Grid.ColumnDefinitions>

                                            <CheckBox IsChecked="{Binding IsInUnion}" VerticalAlignment="Center" />
                                            <ComboBox Grid.Column="1" IsEnabled="{Binding IsInUnion}" ItemsSource="{Binding ElementName=VersionList, Path=SelectedItem.Unions}" SelectedItem="{Binding UnionObject}" DisplayMemberPath="Name" />
                                        </Grid>
                                    </HeaderedContentControl>

                                    <HeaderedContentControl Header="Speicherort" Visibility="{Binding IsInUnion, Converter={StaticResource BoolToVis}, ConverterParameter=true}">
                                        <ComboBox ItemsSource="{Binding Source={StaticResource dataSave}}" SelectedItem="{Binding SavePath, Mode=TwoWay}" />
                                    </HeaderedContentControl>

                                    <StackPanel Visibility="{Binding IsInUnion, Converter={StaticResource BoolToVis}}">
                                        <HeaderedContentControl Header="Union Speicher">
                                            <TextBlock Text="{Binding UnionObject.MemoryObject.Name}" />
                                        </HeaderedContentControl>
                                        <HeaderedContentControl Header="Offset">
                                            <TextBox Text="{Binding Offset, UpdateSourceTrigger=PropertyChanged}"/>
                                        </HeaderedContentControl>
                                        <HeaderedContentControl Header="Bit Offset">
                                            <TextBox Text="{Binding OffsetBit, UpdateSourceTrigger=PropertyChanged}"/>
                                        </HeaderedContentControl>
                                    </StackPanel>

                                    <Grid Visibility="{Binding IsInUnion, Converter={StaticResource BoolToVis}, ConverterParameter=true}">
                                        <StackPanel Visibility="{Binding SavePath, Converter={StaticResource EnumToVis}, ConverterParameter=Memory}">
                                            <HeaderedContentControl Header="Speicher auswählen">
                                                <ComboBox ItemsSource="{Binding ElementName=VersionList, Path=SelectedItem.Memories}" SelectedItem="{Binding MemoryObject, Mode=TwoWay}" DisplayMemberPath="Name" />
                                            </HeaderedContentControl>

                                            <StackPanel Visibility="{Binding MemoryObject.IsAutoPara, Converter={StaticResource BoolToVis}, ConverterParameter=true}">
                                                <CheckBox IsChecked="{Binding IsOffsetAuto}" Content="Automatisch im Speicher anordnen" />

                                                <StackPanel IsEnabled="{Binding IsOffsetAuto, Converter={StaticResource BoolNegate}}">
                                                    <HeaderedContentControl Header="Offset">
                                                        <TextBox Text="{Binding Offset, UpdateSourceTrigger=PropertyChanged}"/>
                                                    </HeaderedContentControl>
                                                    <HeaderedContentControl Header="Bit Offset">
                                                        <TextBox Text="{Binding OffsetBit, UpdateSourceTrigger=PropertyChanged}"/>
                                                    </HeaderedContentControl>
                                                </StackPanel>
                                            </StackPanel>

                                            <TextBlock Text="Adresse wird automatisch festgelegt (Speicher)" Margin="5" Visibility="{Binding MemoryObject.IsAutoPara, Converter={StaticResource BoolToVis}}" />

                                            <Border Visibility="{Binding MemoryObject.IsAutoPara, Converter={StaticResource BoolToVis}}">
                                                <TextBlock Margin="5">
                                                        <Run Text="Offset:" />
                                                        <Run Text="{Binding Offset, Mode=OneWay}" />
                                                        <LineBreak />
                                                        <Run Text="Bit Offset:" />
                                                        <Run Text="{Binding OffsetBit, Mode=OneWay}" />
                                                </TextBlock>
                                            </Border>
                                        </StackPanel>

                                        <StackPanel Visibility="{Binding SavePath, Converter={StaticResource EnumToVis}, ConverterParameter=Property}">
                                            <TextBlock Text="Properties werden noch nicht unterstütz" />
                                        </StackPanel>
                                    </Grid>
                                </StackPanel>
                            </ScrollViewer>

                            </Grid>
                    </TabItem>

                    <TabItem Header="ParameterRefs" Visibility="{Binding IsParameterRefAuto, Converter={StaticResource BoolToVis}, ConverterParameter=true}" Style="{StaticResource LeftTabItem}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="auto" />
                                <RowDefinition Height="auto" />
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150" />
                                <ColumnDefinition Width="150" />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <Button Content="Hinzufügen" Click="ClickAddParamRef" Margin="0 0 1 2" />
                            <Button Grid.Column="1" Content="Löschen" Click="ClickRemoveParamRef" Margin="1 0 0 2" />
                            <Button Grid.Row="1" Grid.ColumnSpan="2" Content="Auto generieren" Click="ClickGenerateRefAuto" Margin="0 0 0 2" />

                            <ListView x:Name="ParamRefList" Grid.Row="2" Grid.ColumnSpan="2" ItemsSource="{Binding ParameterRefs}" DisplayMemberPath="Name" />


                            <StackPanel Grid.Column="3" Grid.RowSpan="3" Margin="5" DataContext="{Binding ElementName=ParamRefList, Path=SelectedItem}" IsEnabled="{Binding Converter={StaticResource EmptyToBool}, ConverterParameter=true}">
                                <StackPanel.Resources>
                                    <ObjectDataProvider x:Key="dataFromEnum" MethodName="GetValues" ObjectType="{x:Type System:Enum}">
                                        <ObjectDataProvider.MethodParameters>
                                            <x:Type TypeName="models:ParamAccess"/>
                                        </ObjectDataProvider.MethodParameters>
                                    </ObjectDataProvider>
                                    <Style TargetType="HeaderedContentControl">
                                        <Setter Property="Margin" Value="5" />
                                        <Setter Property="IsTabStop" Value="false" />
                                    </Style>
                                    <Style TargetType="ComboBox">
                                        <Setter Property="Margin" Value="0 5" />
                                    </Style>
                                    <Style TargetType="CheckBox">
                                        <Setter Property="Margin" Value="5" />
                                    </Style>
                                    <Style TargetType="Button">
                                        <Setter Property="Margin" Value="5" />
                                    </Style>
                                </StackPanel.Resources>

                                
                                <TextBlock Margin="5 0" VerticalAlignment="Center">
                                    <Run Text="UID:" />
                                    <Run Text="{Binding UId}"/>
                                </TextBlock>


                                <Grid Margin="5 0">
                                    <TextBlock VerticalAlignment="Center">
                                        <Run Text="ID:" />
                                        <Run Text="{Binding Id, UpdateSourceTrigger=PropertyChanged}"/>
                                    </TextBlock>
                                    <Button Content="Zurücksetzen" HorizontalAlignment="Right" Click="ResetId" />
                                </Grid>
                                <HeaderedContentControl Header="Name">
                                    <TextBox Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}"/>
                                </HeaderedContentControl>
                                <HeaderedContentControl Header="Parameter">
                                    <ComboBox ItemsSource="{Binding ElementName=ParamList, Path=Items}" DisplayMemberPath="Name" SelectedItem="{Binding ParameterObject}" />
                                </HeaderedContentControl>
                                <HeaderedContentControl Header="Wert">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="auto" />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>

                                        <CheckBox IsChecked="{Binding OverwriteValue}" VerticalAlignment="Center" />
                                        <TextBox Grid.Column="2" IsEnabled="{Binding OverwriteValue}" Text="{Binding Value, UpdateSourceTrigger=PropertyChanged}" VerticalAlignment="Center" />
                                    </Grid>
                                </HeaderedContentControl>
                                <HeaderedContentControl Header="Zugriff">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="auto" />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>

                                        <CheckBox IsChecked="{Binding OverwriteAccess}" VerticalAlignment="Center" />
                                        <ComboBox Grid.Column="2" IsEnabled="{Binding OverwriteAccess}" ItemsSource="{Binding Source={StaticResource dataFromEnum}}" SelectedItem="{Binding Access, Mode=TwoWay}" />
                                    </Grid>
                                </HeaderedContentControl>
                            </StackPanel>
                        </Grid>
                    </TabItem>

                    <TabItem Header="Comobjects" Style="{StaticResource LeftTabItem}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="auto" />
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150" />
                                <ColumnDefinition Width="150" />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <Button Content="Hinzufügen" Margin="0 0 1 2" Click="ClickAddCom" />
                            <Button Grid.Column="1" Content="Löschen" Click="ClickRemoveCom" Margin="1 0 0 2" IsEnabled="{Binding ElementName=ComobjectList, Path=SelectedItem, Converter={StaticResource EmptyToBool}, ConverterParameter=true}" />

                            <ListView x:Name="ComobjectList" Grid.Row="1" Grid.ColumnSpan="2" ItemsSource="{Binding ComObjects}" DisplayMemberPath="Name" />

                            <ScrollViewer Grid.Column="3" Grid.RowSpan="2" DataContext="{Binding ElementName=ComobjectList, Path=SelectedItem}" IsEnabled="{Binding Converter={StaticResource EmptyToBool}, ConverterParameter=true}">
                                <StackPanel Margin="5">
                                    <StackPanel.Resources>
                                        <ObjectDataProvider x:Key="dataFromEnum" MethodName="GetValues" ObjectType="{x:Type System:Enum}">
                                            <ObjectDataProvider.MethodParameters>
                                                <x:Type TypeName="models:ParamAccess"/>
                                            </ObjectDataProvider.MethodParameters>
                                        </ObjectDataProvider>
                                        <ObjectDataProvider x:Key="dataFromCom" MethodName="GetValues" ObjectType="{x:Type System:Enum}">
                                            <ObjectDataProvider.MethodParameters>
                                                <x:Type TypeName="models:FlagType"/>
                                            </ObjectDataProvider.MethodParameters>
                                        </ObjectDataProvider>
                                        <Style TargetType="HeaderedContentControl">
                                            <Setter Property="Margin" Value="5" />
                                            <Setter Property="IsTabStop" Value="false" />
                                        </Style>
                                        <Style TargetType="CheckBox">
                                            <Setter Property="Margin" Value="5" />
                                        </Style>
                                        <Style TargetType="ComboBox">
                                            <Setter Property="Margin" Value="0 5" />
                                        </Style>
                                        <Style TargetType="Button">
                                            <Setter Property="Margin" Value="5" />
                                        </Style>
                                        <Style TargetType="ListView">
                                            <Setter Property="Margin" Value="5" />
                                        </Style>
                                    </StackPanel.Resources>

                                        
                                    <TextBlock Margin="5 0" VerticalAlignment="Center">
                                        <Run Text="UID:" />
                                        <Run Text="{Binding UId}"/>
                                    </TextBlock>


                                    <Grid Margin="5 0">
                                        <TextBlock VerticalAlignment="Center">
                                            <Run Text="ID:" />
                                            <Run Text="{Binding Id}"/>
                                        </TextBlock>
                                        <Button Content="Zurücksetzen" HorizontalAlignment="Right" Click="ResetId" />
                                    </Grid>

                                    <HeaderedContentControl Header="Name">
                                        <TextBox Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}" />
                                    </HeaderedContentControl>

                                    <HeaderedContentControl Header="Text">
                                        <StackPanel>
                                            <CheckBox IsChecked="{Binding TranslationText}" Content="Übersetzung nicht exportieren" />
                                            <DataGrid ItemsSource="{Binding Text}" AutoGenerateColumns="False" CanUserDeleteRows="False" CanUserAddRows="False" CanUserSortColumns="False" CanUserResizeRows="False">
                                                <DataGrid.Columns>
                                                    <DataGridTextColumn Header="Sprache" Binding="{Binding Language.Text}" IsReadOnly="True" />
                                                    <DataGridTextColumn Header="Text" Binding="{Binding Text, UpdateSourceTrigger=PropertyChanged}" />
                                                </DataGrid.Columns>
                                            </DataGrid>
                                        </StackPanel>
                                    </HeaderedContentControl>

                                    <HeaderedContentControl Header="Funktionstext">
                                        <StackPanel>
                                            <CheckBox IsChecked="{Binding TranslationFunctionText}" Content="Übersetzung nicht exportieren" />
                                            <DataGrid ItemsSource="{Binding FunctionText}" AutoGenerateColumns="False" CanUserDeleteRows="False" CanUserAddRows="False" CanUserSortColumns="False" CanUserResizeRows="False">
                                                <DataGrid.Columns>
                                                    <DataGridTextColumn Header="Sprache" Binding="{Binding Language.Text}" IsReadOnly="True" />
                                                    <DataGridTextColumn Header="Text" Binding="{Binding Text, UpdateSourceTrigger=PropertyChanged}" />
                                                </DataGrid.Columns>
                                            </DataGrid>
                                        </StackPanel>
                                    </HeaderedContentControl>

                                    <HeaderedContentControl Header="Beschreibung">
                                        <StackPanel>
                                            <CheckBox IsChecked="{Binding TranslationDescription}" Content="Übersetzung nicht exportieren" />
                                            <DataGrid ItemsSource="{Binding Description}" AutoGenerateColumns="False" CanUserDeleteRows="False" CanUserAddRows="False" CanUserSortColumns="False" CanUserResizeRows="False">
                                                <DataGrid.Columns>
                                                    <DataGridTextColumn Header="Sprache" Binding="{Binding Language.Text}" IsReadOnly="True" />
                                                    <DataGridTextColumn Header="Text" Binding="{Binding Text, UpdateSourceTrigger=PropertyChanged}" />
                                                </DataGrid.Columns>
                                            </DataGrid>
                                        </StackPanel>
                                    </HeaderedContentControl>

                                    <HeaderedContentControl Header="Nummer">
                                        <TextBox Text="{Binding Number}" />
                                    </HeaderedContentControl>

                                    <HeaderedContentControl Header="DataPointType">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="auto" />
                                                <ColumnDefinition />
                                            </Grid.ColumnDefinitions>

                                            <CheckBox IsChecked="{Binding HasDpt}" VerticalAlignment="Center" />
                                            <ComboBox Grid.Column="1" IsEnabled="{Binding HasDpt}" Name="InComType" ItemsSource="{Binding DPTs, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}" SelectedItem="{Binding Type}" DisplayMemberPath="Name" />
                                        </Grid>
                                    </HeaderedContentControl>

                                    <HeaderedContentControl Header="DataPointSubType" IsEnabled="{Binding HasDpt}">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="auto" />
                                                <ColumnDefinition />
                                            </Grid.ColumnDefinitions>

                                            <CheckBox IsChecked="{Binding HasDpts}" VerticalAlignment="Center" />
                                            <ComboBox Grid.Column="1" IsEnabled="{Binding HasDpts}" ItemsSource="{Binding ElementName=InComType, Path=SelectedItem.SubTypes}" SelectedItem="{Binding SubType}" DisplayMemberPath="Name" />
                                        </Grid>
                                    </HeaderedContentControl>


                                    <HeaderedContentControl Header="Flag Kommunikation" Margin="5 30 5 5">
                                        <ComboBox ItemsSource="{Binding Source={StaticResource dataFromCom}}" SelectedItem="{Binding FlagComm}" />
                                    </HeaderedContentControl>
                                    <HeaderedContentControl Header="Flag Lesen">
                                        <ComboBox ItemsSource="{Binding Source={StaticResource dataFromCom}}" SelectedItem="{Binding FlagRead}" />
                                    </HeaderedContentControl>
                                    <HeaderedContentControl Header="Flag Schreiben">
                                        <ComboBox ItemsSource="{Binding Source={StaticResource dataFromCom}}" SelectedItem="{Binding FlagWrite}" />
                                    </HeaderedContentControl>
                                    <HeaderedContentControl Header="Flag Übertragen">
                                        <ComboBox ItemsSource="{Binding Source={StaticResource dataFromCom}}" SelectedItem="{Binding FlagTrans}" />
                                    </HeaderedContentControl>
                                    <HeaderedContentControl Header="Flag Aktualisieren">
                                        <ComboBox ItemsSource="{Binding Source={StaticResource dataFromCom}}" SelectedItem="{Binding FlagUpdate}" />
                                    </HeaderedContentControl>
                                    <HeaderedContentControl Header="Flag Lesen bei Init">
                                        <ComboBox ItemsSource="{Binding Source={StaticResource dataFromCom}}" SelectedItem="{Binding FlagOnInit}" />
                                    </HeaderedContentControl>
                                </StackPanel>
                            </ScrollViewer>
                        </Grid>
                    </TabItem>

                    <TabItem Header="ComobjectRefs" Visibility="{Binding IsComObjectRefAuto, Converter={StaticResource BoolToVis}, ConverterParameter=true}" Style="{StaticResource LeftTabItem}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="auto" />
                                <RowDefinition Height="auto" />
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150" />
                                <ColumnDefinition Width="150" />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <Button Content="Hinzufügen" Margin="0 0 1 2" Click="ClickAddComRef" />
                            <Button Grid.Column="1" Content="Löschen" Click="ClickRemoveComRef" Margin="1 0 0 2" IsEnabled="{Binding ElementName=ComobjectRefList, Path=SelectedItem, Converter={StaticResource EmptyToBool}, ConverterParameter=true}" />
                            <Button Grid.Row="1" Grid.ColumnSpan="2" Content="Auto generieren" Click="ClickGenerateRefAuto2" Margin="0 0 0 2" />

                            <ListView x:Name="ComobjectRefList" Grid.Row="2" Grid.ColumnSpan="2" ItemsSource="{Binding ComObjectRefs}" DisplayMemberPath="Name" />

                            <ScrollViewer Grid.Column="3" Grid.RowSpan="3" DataContext="{Binding ElementName=ComobjectRefList, Path=SelectedItem}" IsEnabled="{Binding Converter={StaticResource EmptyToBool}, ConverterParameter=true}">
                                <StackPanel Margin="5">
                                    <StackPanel.Resources>
                                        <ObjectDataProvider x:Key="dataFromCom" MethodName="GetValues" ObjectType="{x:Type System:Enum}">
                                            <ObjectDataProvider.MethodParameters>
                                                <x:Type TypeName="models:FlagType"/>
                                            </ObjectDataProvider.MethodParameters>
                                        </ObjectDataProvider>
                                        <Style TargetType="HeaderedContentControl">
                                            <Setter Property="Margin" Value="5" />
                                            <Setter Property="IsTabStop" Value="false" />
                                        </Style>
                                        <Style TargetType="CheckBox">
                                            <Setter Property="Margin" Value="5" />
                                        </Style>
                                        <Style TargetType="ComboBox">
                                            <Setter Property="Margin" Value="0 5" />
                                        </Style>
                                        <Style TargetType="Button">
                                            <Setter Property="Margin" Value="5" />
                                        </Style>
                                        <Style TargetType="ListView">
                                            <Setter Property="Margin" Value="5" />
                                        </Style>
                                    </StackPanel.Resources>

                                    
                                    <TextBlock Margin="5 0" VerticalAlignment="Center">
                                        <Run Text="UID:" />
                                        <Run Text="{Binding UId}"/>
                                    </TextBlock>

                                    <Grid Margin="5 0">
                                        <TextBlock VerticalAlignment="Center">
                                            <Run Text="ID:" />
                                            <Run Text="{Binding Id}"/>
                                        </TextBlock>
                                        <Button Content="Zurücksetzen" HorizontalAlignment="Right" Click="ResetId" />
                                    </Grid>

                                    <HeaderedContentControl Header="Name">
                                        <TextBox Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}" />
                                    </HeaderedContentControl>

                                    <HeaderedContentControl Header="Kommunikationsobjekt">
                                        <ComboBox ItemsSource="{Binding ElementName=ComobjectList, Path=Items}" DisplayMemberPath="Name" SelectedItem="{Binding ComObjectObject}" />
                                    </HeaderedContentControl>
                                    
                                    <HeaderedContentControl Header="Text">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="auto" />
                                                <ColumnDefinition />
                                            </Grid.ColumnDefinitions>

                                            <CheckBox IsChecked="{Binding OverwriteText}" VerticalAlignment="Center" />
                                            <StackPanel Grid.Column="1">
                                                <CheckBox IsEnabled="{Binding OverwriteText}" IsChecked="{Binding TranslationText}" Content="Übersetzung nicht exportieren" />
                                                <DataGrid IsEnabled="{Binding OverwriteText}" ItemsSource="{Binding Text}" AutoGenerateColumns="False" CanUserDeleteRows="False" CanUserAddRows="False" CanUserSortColumns="False" CanUserResizeRows="False">
                                                    <DataGrid.Columns>
                                                        <DataGridTextColumn Header="Sprache" Binding="{Binding Language.Text}" IsReadOnly="True" />
                                                        <DataGridTextColumn Header="Text" Binding="{Binding Text, UpdateSourceTrigger=PropertyChanged}" />
                                                    </DataGrid.Columns>
                                                </DataGrid>
                                            </StackPanel>
                                        </Grid>
                                    </HeaderedContentControl>

                                    <HeaderedContentControl Header="Funktionstext">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="auto" />
                                                <ColumnDefinition />
                                            </Grid.ColumnDefinitions>

                                            <CheckBox IsChecked="{Binding OverwriteFunctionText}" VerticalAlignment="Center" />
                                            <StackPanel Grid.Column="1">
                                                <CheckBox IsEnabled="{Binding OverwriteFunctionText}" IsChecked="{Binding TranslationFunctionText}" Content="Übersetzung nicht exportieren" />
                                                <DataGrid IsEnabled="{Binding OverwriteFunctionText}" ItemsSource="{Binding FunctionText}" AutoGenerateColumns="False" CanUserDeleteRows="False" CanUserAddRows="False" CanUserSortColumns="False" CanUserResizeRows="False">
                                                    <DataGrid.Columns>
                                                        <DataGridTextColumn Header="Sprache" Binding="{Binding Language.Text}" IsReadOnly="True" />
                                                        <DataGridTextColumn Header="Text" Binding="{Binding Text, UpdateSourceTrigger=PropertyChanged}" />
                                                    </DataGrid.Columns>
                                                </DataGrid>
                                            </StackPanel>
                                        </Grid>
                                    </HeaderedContentControl>

                                    <HeaderedContentControl Header="Beschreibung">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="auto" />
                                                <ColumnDefinition />
                                            </Grid.ColumnDefinitions>

                                            <CheckBox IsChecked="{Binding OverwriteDescription}" VerticalAlignment="Center" />
                                            <StackPanel Grid.Column="1">
                                                <CheckBox IsEnabled="{Binding OverwriteDescription}" IsChecked="{Binding TranslationDescription}" Content="Übersetzung nicht exportieren" />
                                                <DataGrid IsEnabled="{Binding OverwriteDescription}" ItemsSource="{Binding Description}" AutoGenerateColumns="False" CanUserDeleteRows="False" CanUserAddRows="False" CanUserSortColumns="False" CanUserResizeRows="False">
                                                    <DataGrid.Columns>
                                                        <DataGridTextColumn Header="Sprache" Binding="{Binding Language.Text}" IsReadOnly="True" />
                                                        <DataGridTextColumn Header="Text" Binding="{Binding Text, UpdateSourceTrigger=PropertyChanged}" />
                                                    </DataGrid.Columns>
                                                </DataGrid>
                                            </StackPanel>
                                        </Grid>
                                    </HeaderedContentControl>

                                    <HeaderedContentControl Header="DataPointType">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="auto" />
                                                <ColumnDefinition />
                                            </Grid.ColumnDefinitions>

                                            <CheckBox IsChecked="{Binding OverwriteDpt}" VerticalAlignment="Center" />
                                            <ComboBox Grid.Column="1" IsEnabled="{Binding OverwriteDpt}" Name="InComRefType" ItemsSource="{Binding DPTs, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}" SelectedItem="{Binding Type}" DisplayMemberPath="Name" />
                                        </Grid>
                                    </HeaderedContentControl>


                                    <HeaderedContentControl Header="DataPointSubType" IsEnabled="{Binding OverwriteDpt}">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="auto" />
                                                <ColumnDefinition />
                                            </Grid.ColumnDefinitions>

                                            <CheckBox IsChecked="{Binding OverwriteDpst}" VerticalAlignment="Center" />
                                            <ComboBox Grid.Column="1" IsEnabled="{Binding OverwriteDpst}" ItemsSource="{Binding ElementName=InComRefType, Path=SelectedItem.SubTypes}" SelectedItem="{Binding SubType}" DisplayMemberPath="Name" />
                                        </Grid>
                                    </HeaderedContentControl>


                                    <HeaderedContentControl Header="Flag Kommunikation" Margin="5 30 5 5">
                                        <ComboBox ItemsSource="{Binding Source={StaticResource dataFromCom}}" SelectedItem="{Binding FlagComm}" />
                                    </HeaderedContentControl>
                                    <HeaderedContentControl Header="Flag Lesen">
                                        <ComboBox ItemsSource="{Binding Source={StaticResource dataFromCom}}" SelectedItem="{Binding FlagRead}" />
                                    </HeaderedContentControl>
                                    <HeaderedContentControl Header="Flag Schreiben">
                                        <ComboBox ItemsSource="{Binding Source={StaticResource dataFromCom}}" SelectedItem="{Binding FlagWrite}" />
                                    </HeaderedContentControl>
                                    <HeaderedContentControl Header="Flag Übertragen">
                                        <ComboBox ItemsSource="{Binding Source={StaticResource dataFromCom}}" SelectedItem="{Binding FlagTrans}" />
                                    </HeaderedContentControl>
                                    <HeaderedContentControl Header="Flag Aktualisieren">
                                        <ComboBox ItemsSource="{Binding Source={StaticResource dataFromCom}}" SelectedItem="{Binding FlagUpdate}" />
                                    </HeaderedContentControl>
                                    <HeaderedContentControl Header="Flag Lesen bei Init">
                                        <ComboBox ItemsSource="{Binding Source={StaticResource dataFromCom}}" SelectedItem="{Binding FlagOnInit}" />
                                    </HeaderedContentControl>
                                </StackPanel>
                            </ScrollViewer>
                        </Grid>
                    </TabItem>


                    <TabItem DataContext="{Binding SelectedItem, ElementName=AppList}" Header="Ladeprozedur" Style="{StaticResource LeftTabItem}">
                        <Grid>  
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition />
                                <ColumnDefinition Width="5" />
                                <ColumnDefinition MaxWidth="600" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="auto" MaxHeight="250" />
                                <RowDefinition />
                            </Grid.RowDefinitions>

                            <!--<TextBox Grid.RowSpan="2" Text="{Binding Mask.OwnProcedure}" />-->
                            <avalonedit:TextEditor x:Name="editor" ShowLineNumbers="True" Grid.RowSpan="2" SyntaxHighlighting="XML" />
                            
                            <GridSplitter Grid.RowSpan="2" Grid.Column="1" Width="5" HorizontalAlignment="Stretch" />

                            <ListBox x:Name="MaskList" Grid.Column="2" ItemsSource="{Binding Mask.Procedures}">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock>
                                            <Run Text="{Binding Type}" />
                                            <Run Text="-" />
                                            <Run Text="{Binding SubType}" />
                                        </TextBlock>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                            <ScrollViewer Grid.Row="1" Grid.Column="2">
                                <TextBlock Text="{Binding SelectedItem.Controls, ElementName=MaskList}" Margin="5" />
                            </ScrollViewer>
                        </Grid>
                    </TabItem>


                    <TabItem Header="Dynamic" Style="{StaticResource LeftTabItem}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="auto" />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>

                            <TreeView Name="DynamicList" ItemsSource="{Binding ElementName=VersionList, Path=SelectedItem.Dynamics}" MinWidth="300">
                                <TreeView.Resources>
                                    <HierarchicalDataTemplate DataType="{x:Type dyn:DynamicMain}" ItemsSource="{Binding Items}">
                                        <TextBlock Text="{Binding Name}">
                                            <TextBlock.ContextMenu>
                                                <ContextMenu>
                                                    <MenuItem Header="Independent Channel hinzufügen" Click="ClickAddDynIndep" />
                                                    <MenuItem Header="Channel hinzufügen" Click="ClickAddDynChannel" />
                                                    <MenuItem Header="Abzweigung hinzufügen" Click="ClickAddDynChoose" />
                                                </ContextMenu>
                                            </TextBlock.ContextMenu>
                                        </TextBlock>
                                    </HierarchicalDataTemplate>
                                    <HierarchicalDataTemplate DataType="{x:Type dyn:DynChannel}" ItemsSource="{Binding Items}">
                                        <TextBlock>
                                            <TextBlock.ContextMenu>
                                                <ContextMenu>
                                                    <MenuItem Header="Block hinzufügen" Click="ClickAddDynBlock" />
                                                    <MenuItem Header="Abzweigung hinzufügen" Click="ClickAddDynChoose" />
                                                    <Separator />
                                                    <MenuItem Header="Entfernen" Click="ClickRemoveDyn" />
                                                </ContextMenu>
                                            </TextBlock.ContextMenu>
                                            <Run Text="Channel" />
                                            <Run Text="{Binding Name}" />
                                        </TextBlock>
                                    </HierarchicalDataTemplate>
                                    <HierarchicalDataTemplate DataType="{x:Type dyn:DynChannelIndependet}" ItemsSource="{Binding Items}">
                                        <TextBlock Text="Channel Independent">
                                            <TextBlock.ContextMenu>
                                                <ContextMenu>
                                                    <MenuItem Header="Block hinzufügen" Click="ClickAddDynBlock" />
                                                    <MenuItem Header="Abzweigung hinzufügen" Click="ClickAddDynChoose" />
                                                    <Separator />
                                                    <MenuItem Header="Entfernen" Click="ClickRemoveDyn" />
                                                </ContextMenu>
                                            </TextBlock.ContextMenu>
                                        </TextBlock>
                                    </HierarchicalDataTemplate>
                                    <HierarchicalDataTemplate DataType="{x:Type dyn:DynParaBlock}" ItemsSource="{Binding Items}">
                                        <TextBlock>
                                            <TextBlock.ContextMenu>
                                                <ContextMenu>
                                                    <MenuItem Header="Parameter hinzufügen" Click="ClickAddDynPara" />
                                                    <MenuItem Header="KO hinzufügen" Click="ClickAddDynCom" />
                                                    <MenuItem Header="Separator hinzufügen" Click="ClickAddDynSep" />
                                                    <MenuItem Header="Abzweigung hinzufügen" Click="ClickAddDynChoose" />
                                                    <Separator />
                                                    <MenuItem Header="Entfernen" Click="ClickRemoveDyn" />
                                                </ContextMenu>
                                            </TextBlock.ContextMenu>
                                            <Run Text="Block" />
                                            <Run Text="{Binding Name}" />
                                        </TextBlock>
                                    </HierarchicalDataTemplate>
                                    <HierarchicalDataTemplate DataType="{x:Type dyn:DynChoose}" ItemsSource="{Binding Items}">
                                        <TextBlock>
                                            <TextBlock.ContextMenu>
                                                <ContextMenu>
                                                    <MenuItem Header="Bedingung hinzufügen" Click="ClickAddDynWhen" />
                                                    <MenuItem Header="Entfernen" Click="ClickRemoveDyn" />
                                                </ContextMenu>
                                            </TextBlock.ContextMenu>
                                            <Run Text="Auswahl" />
                                            <Run Text="{Binding Name}" />
                                        </TextBlock>
                                    </HierarchicalDataTemplate>
                                    <HierarchicalDataTemplate DataType="{x:Type dyn:DynWhen}" ItemsSource="{Binding Items}">
                                        <TextBlock>
                                            <TextBlock.ContextMenu>
                                                <ContextMenu Loaded="LoadingContextDynWhen">
                                                    <MenuItem Header="Independent Channel hinzufügen" Click="ClickAddDynIndep" />
                                                    <MenuItem Header="Channel hinzufügen" />
                                                    <MenuItem Header="Block hinzufügen" Click="ClickAddDynBlock" />
                                                    <MenuItem Header="Abzweigung hinzufügen" Click="ClickAddDynChoose" />
                                                    <Separator />
                                                    <MenuItem Header="Parameter hinzufügen" Click="ClickAddDynPara" />
                                                    <MenuItem Header="KO hinzufügen" Click="ClickAddDynCom" />
                                                    <MenuItem Header="Separator hinzufügen" Click="ClickAddDynSep" />
                                                    <MenuItem Header="Entfernen" Click="ClickRemoveDyn" />
                                                </ContextMenu>
                                            </TextBlock.ContextMenu>
                                            <Run Text="Bedingung" />
                                            <Run Text="{Binding Name}" />
                                        </TextBlock>
                                    </HierarchicalDataTemplate>
                                    <DataTemplate DataType="{x:Type dyn:DynParameter}">
                                        <StackPanel Orientation="Horizontal">
                                            <StackPanel.ContextMenu>
                                                <ContextMenu>
                                                    <MenuItem Header="Entfernen" Click="ClickRemoveDyn" />
                                                </ContextMenu>
                                            </StackPanel.ContextMenu>
                                            <TextBlock>
                                                <Run Text="Parameter" />
                                                <Run Text="{Binding Name}" />
                                                <Run Text="{Binding ParameterRefObject.Name}" />
                                            </TextBlock>
                                            <!-- Visibility="{Binding ElementName=VersionList, Path=SelectedItem.IsParameterRefAuto, Converter={StaticResource BoolToVis}}"-->
                                            <TextBlock Margin="10 0 0 0">
                                                <Run Text="[" />
                                                <Run Text="{Binding ParameterRefObject.ParameterObject.Name}" />
                                                <Run Text="]" />
                                            </TextBlock>
                                        </StackPanel>
                                    </DataTemplate>
                                    <DataTemplate DataType="{x:Type dyn:DynComObject}">
                                        <StackPanel Orientation="Horizontal">
                                            <StackPanel.ContextMenu>
                                                <ContextMenu>
                                                    <MenuItem Header="Entfernen" Click="ClickRemoveDyn" />
                                                </ContextMenu>
                                            </StackPanel.ContextMenu>
                                            <TextBlock>
                                                <Run Text="KO" />
                                                <Run Text="{Binding Name}" />
                                                <Run Text="{Binding ComObjectRefObject.Name}" />
                                            </TextBlock>
                                            <TextBlock Margin="10 0 0 0">
                                                <Run Text="[" />
                                                <Run Text="{Binding ComObjectRefObject.ComObjectObject.Name}" />
                                                <Run Text="]" />
                                            </TextBlock>
                                        </StackPanel>
                                    </DataTemplate>
                                </TreeView.Resources>
                            </TreeView>

                            <StackPanel Grid.Column="1" DataContext="{Binding ElementName=DynamicList, Path=SelectedItem}">
                                <StackPanel.Resources>
                                    <Style TargetType="HeaderedContentControl">
                                        <Setter Property="Margin" Value="5" />
                                    </Style>
                                    <Style TargetType="CheckBox">
                                        <Setter Property="Margin" Value="5" />
                                    </Style>
                                    <Style TargetType="ComboBox">
                                        <Setter Property="Margin" Value="0" />
                                    </Style>
                                    <Style TargetType="Button">
                                        <Setter Property="Margin" Value="5" />
                                    </Style>
                                    <Style TargetType="ListView">
                                        <Setter Property="Margin" Value="5" />
                                    </Style>
                                </StackPanel.Resources>

                                <ContentPresenter Content="{Binding ElementName=DynamicList, Path=SelectedItem}" ContentTemplateSelector="{StaticResource SelectorDyn}" />
                            </StackPanel>
                        </Grid>
                    </TabItem>


                </TabControl>
            </TabItem>

            <TabItem Style="{StaticResource TopTabItem}">
                <TabItem.Header>
                    <TextBlock FontSize="18" Text="{x:Static p:Resources.tabs_pub}" MouseLeftButtonUp="TabItem_MouseLeftButtonUp" />
                </TabItem.Header>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="auto" />
                        <RowDefinition />
                    </Grid.RowDefinitions>

                    <DataGrid Grid.RowSpan="2" Name="ExportList" AutoGenerateColumns="False" BorderThickness="0 0 1 0">
                        <DataGrid.Columns>
                            <DataGridCheckBoxColumn Header="Publish" Binding="{Binding Selected}" />
                            <DataGridTextColumn Header="Gerät" Binding="{Binding Device.Name}" />
                            <DataGridTextColumn Header="Hardware" Binding="{Binding Hardware.Name}" />
                            <DataGridTextColumn Header="Applikation" Binding="{Binding App.Name}" />
                            <DataGridTextColumn Header="Version" Binding="{Binding Version.NameText}" />
                        </DataGrid.Columns>
                    </DataGrid>

                    <StackPanel Grid.Column="1">
                        <StackPanel.Resources>
                            <Style TargetType="HeaderedContentControl">
                                <Setter Property="Margin" Value="5" />
                            </Style>
                            <Style TargetType="CheckBox">
                                <Setter Property="Margin" Value="5" />
                            </Style>
                            <Style TargetType="ComboBox">
                                <Setter Property="Margin" Value="5" />
                            </Style>
                            <Style TargetType="Button">
                                <Setter Property="Margin" Value="5" />
                            </Style>
                            <Style TargetType="ListView">
                                <Setter Property="Margin" Value="5" />
                            </Style>
                        </StackPanel.Resources>
                        <HeaderedContentControl Header="Filtern:">
                            <TextBox x:Name="ExportInFilter" TextChanged="ExportInFilter_TextChanged" />
                        </HeaderedContentControl>

                        <CheckBox x:Name="InPublishOnlyLatest" Content="Nur neueste Applikationversion exportieren" Checked="ChangedPublishOnlyLatest" Unchecked="ChangedPublishOnlyLatest" />

                        <ComboBox x:Name="InPublishTarget" SelectedIndex="0" SelectedValuePath="Tag">
                            <ComboBoxItem Content="ETS" Tag="ets" />
                            <ComboBoxItem Content="Kaenx" Tag="kaenx" IsEnabled="False" />
                        </ComboBox>
                        
                        <Button Content="Veröffentlichen" Click="Button_Click" />
                    </StackPanel>

                    <ScrollViewer Grid.Column="1" Grid.Row="1">
                        <ItemsControl ItemsSource="{Binding PublishActions}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border BorderBrush="Gray" BorderThickness="0 1 0 0">
                                        <StackPanel Margin="10 5">
                                            <TextBlock Text="{Binding Text}" Foreground="{Binding State, Converter={StaticResource StateToBrush}}" />
                                        </StackPanel>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                </Grid>
            </TabItem>
        </TabControl>
    </Grid>
</Window>
